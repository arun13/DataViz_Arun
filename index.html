<!DOCTYPE html>
<meta charset="utf-8">
<style>
    body {
        font: 16px sans-serif;
    }
    .tooltip {
        position: absolute;
        font-size: 12px;
        width:  auto;
        height: auto;
        pointer-events: none;
        background: white;
        border: 1px black;
        color: black;
    }
    .axis--x path {
        display: none;
    }

    .line {
        fill: none;
        stroke: steelblue;
        stroke-width: 1.5px;
    }

</style>
<body>
<div class="jumbotron" style="background-color: gray; color: white" aligncenter>

         <h1 style="padding-left : 2%">Does more forest cover mean more GDP?</h1></div>
    <p style="padding-left : 2%">The line chart of average percentage of forest cover for top 25 countries in terms of average GDP for the past 10 years across various countries depicts the years 1990 through 2015 on the x-axis versus the average percentage of forest cover on the y-axis. </p>
    <p style="padding-left : 2%">Developed nations seem to be holding steady while developing countries seem to have depleting forest cover and very few nations like Belgium are making a concerted effort to improve their forest cover.</p>
    <p style="padding-left : 2%">Perhaps in terms of environmental concern, developing nations need to exercise caution but there does not seem to be a direct correlation between forest cover and GDP. So was Trump right to exit the Paris accord after all?</p>
    <p style="padding-left : 2%"><a href="end.html">Is that it then?</a></p>



    <svg width="960" height="1000"></svg>    <script src="https://d3js.org/d3.v4.js"></script>
</body>
















<script>

    const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
        "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

    var svg = d3.select("svg"),
        margin = {top: 20, right: 80, bottom: 30, left: 50},
        width = svg.attr("width") - margin.left - margin.right,
        height = svg.attr("height") - margin.top - margin.bottom,
        g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var parseTime = d3.timeParse("%m/%d/%Y");

    var x = d3.scaleTime().range([0, width]),
        y = d3.scaleLinear().range([height, 0]),
        z = d3.scaleOrdinal(d3.schemeCategory10);

    var line = d3.line()
        .curve(d3.curveBasis)
        .x(function(d) { return x(d.date); })
        .y(function(d) { return y(d.new_cases); });

    d3.csv("data/owid-covid-data_test.csv",function(error, data) {
        if (error) throw error;

        /*       var countries =  [...new Set(data.map(function(d) {
                   return  d.location;
               }))];
       */
        /*       var monthyear =  data.map(function(d) {
                   return monthNames[(new Date(parseTime(d.date))).getMonth()] +" "+ (new Date(parseTime(d.date))).getFullYear();
               });*/

        /*        var dates =  data.map(function(d) {
                    return (new Date(parseTime(d.date)));
                });*/
        var unique_d1 = {};
        var new_cases_per_country =  data.map(function(d1) {
            if(!unique_d1[d1.location]) {
                unique_d1[d1.location] = true;
                return {
                    country: d1.location,
                    values: data.map(function (d2) {
                        if (d2.location === d1.location) {
                            return {
                                new_cases: parseFloat(d2.new_cases_per_million),
                                date: parseTime(d2.date)
                            }
                        }
                    })
                };
            }
        });
        new_cases_per_country = new_cases_per_country.filter(x => x !== undefined);

        function cleanArray2d(array){
            array.forEach(function (item) {
                item.values = item.values.filter(x => x !== undefined)
            });
            return array;
        }
        new_cases_per_country = cleanArray2d(new_cases_per_country);
        console.log(new_cases_per_country);
        //  console.log(remove);

        x.domain(d3.extent(data, function(d) { return d.date; }));
        /*
                y.domain([
                    d3.min(new_cases_per_country, function(c) { return d3.min(c.values, function(b) {
                     //   console.log(b.new_cases);
                        return b.new_cases;}); }),
                    d3.max(new_cases_per_country, function(c) { return d3.max(c.values, function(b) {
                    //    console.log(b.new_cases);
                        return b.new_cases; }); })
                ]);


                z.domain(new_cases_per_country.map(function(c) { return c.country; }));
                */

    /*        console.log(monthyear);
            console.log(countries);
            console.log(dates);*/
    //  console.log(new_cases);

    g.append("g")
        .attr("class", "axis axis--x")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));
/*

    g.append("g")
        .attr("class", "axis axis--y")
        .call(d3.axisLeft(y))
        .append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", 6)
        .attr("dy", "0.71em")
        .attr("fill", "#000")
        .text("newcases, %");

    var country = g.selectAll(".country")
        .data(new_cases_per_country)
        .enter().append("g")
        .attr("class", "country");

    country.append("path")
        .attr("class", "line")
        .attr("d", function(d) { return line(d.values); })
        .style("stroke", function(d) { return z(d.country); });
*/

/*
    country.append("text")
        .datum(function(d) { return {country: d.country, value: d.values[d.values.length - 1]}; })
        .attr("transform", function(d) { return "translate(" + x(d.value.date) + "," + y(d.value.new_cases) + ")"; })
        .attr("x", 3)
        .attr("dy", "0.35em")
        .style("font", "10px sans-serif")
        .text(function(d) { return d.country; });
*/
    });


</script>
